<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jadwal Dinas CNSD - AirNav</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>
        // Konfigurasi warna kustom AirNav
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'airnav-blue': '#255A9B',
                        'airnav-red': '#D92D20',
                        'indigo-600': '#255A9B',
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .modal-body {
            max-height: 70vh;
            overflow-y: auto;
        }
    </style>
</head>
<body class="bg-gray-100">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        <!-- Header Halaman -->
        <header class="bg-white shadow-md rounded-lg p-4 mb-6 flex items-center justify-between">
            <div class="flex items-center">
                <a href="../index.html#cnsd-content" class="p-2 rounded-md hover:bg-gray-200" aria-label="Kembali ke Dashboard">
                    <svg class="w-6 h-6 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                </a>
                <h1 class="text-xl md:text-2xl font-bold text-gray-800 ml-4">Jadwal Dinas CNSD</h1>
            </div>
            <img src="../img/airnav_logo.png" alt="Logo AirNav" class="w-10 h-10 object-contain" onerror="this.onerror=null;this.src='https://placehold.co/40x40/FFFFFF/255A9B?text=A';">
        </header>

        <!-- Main Content -->
        <main class="bg-white p-6 rounded-lg shadow-md">
            <!-- Aksi Tambah Jadwal -->
            <div class="mb-6 flex justify-end">
                <button id="add-schedule-button" class="bg-indigo-600 text-white px-4 py-2 rounded-lg shadow hover:bg-airnav-blue transition-colors text-sm font-medium flex items-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                    Tambah Baru
                </button>
            </div>

            <!-- Tabel Jadwal -->
            <div class="overflow-x-auto">
                <table class="w-full text-sm text-left text-gray-600">
                    <thead class="text-xs text-gray-700 uppercase bg-gray-100">
                        <tr>
                            <th scope="col" class="px-4 py-3 rounded-l-lg">ID Jadwal</th>
                            <th scope="col" class="px-4 py-3">Tanggal</th>
                            <th scope="col" class="px-4 py-3">Hari</th>
                            <th scope="col" class="px-4 py-3">Dinas</th>
                            <th scope="col" class="px-4 py-3">Teknisi 1</th>
                            <th scope="col" class="px-4 py-3">Teknisi 2</th>
                            <th scope="col" class="px-4 py-3">Teknisi 3</th>
                            <th scope="col" class="px-4 py-3">Teknisi 4</th>
                            <th scope="col" class="px-4 py-3">Teknisi 5</th>
                            <th scope="col" class="px-4 py-3">Kode</th>
                            <th scope="col" class="px-4 py-3 rounded-r-lg">Grup</th>
                        </tr>
                    </thead>
                    <tbody id="schedule-table-body">
                        <!-- Data jadwal dari database akan dimasukkan di sini melalui JavaScript -->
                        <tr id="empty-row" class="text-center">
                           <td colspan="11" class="py-10 px-4 text-gray-500">
                                <p>Tidak ada data jadwal untuk ditampilkan.</p>
                                <p class="text-sm">Silakan tambahkan jadwal baru.</p>
                           </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </main>
    </div>

    <!-- Modal Tambah Jadwal -->
    <div id="add-schedule-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 hidden">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-lg">
            <!-- Modal Header -->
            <div class="flex justify-between items-center p-4 border-b">
                <h3 class="text-lg font-semibold text-gray-800">Tambah Jadwal Baru</h3>
                <button id="close-modal-button" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <!-- Modal Body -->
            <form id="schedule-form" class="modal-body p-6 space-y-4">
                <div>
                    <label for="schedule-id" class="block text-sm font-medium text-gray-700">ID Jadwal</label>
                    <input type="text" id="schedule-id" name="schedule-id" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 bg-gray-50" required>
                </div>
                <div>
                    <label for="schedule-date" class="block text-sm font-medium text-gray-700">Tanggal</label>
                    <input type="date" id="schedule-date" name="schedule-date" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500" required>
                </div>
                <div>
                    <label for="schedule-shift" class="block text-sm font-medium text-gray-700">Dinas</label>
                    <select id="schedule-shift" name="schedule-shift" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500" required>
                        <option value="">Pilih Dinas</option>
                        <option value="Pagi">Pagi</option>
                        <option value="Siang">Siang</option>
                        <option value="Malam">Malam</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Teknisi</label>
                    <div id="technician-dropdowns" class="mt-2 space-y-2">
                        <!-- Dropdown akan di-generate oleh JavaScript -->
                    </div>
                </div>
            </form>
            <!-- Modal Footer -->
            <div class="flex justify-end items-center p-4 border-t bg-gray-50 rounded-b-lg">
                <button id="cancel-button" type="button" class="bg-white text-gray-700 px-4 py-2 rounded-lg border border-gray-300 hover:bg-gray-50 text-sm font-medium mr-2">Batal</button>
                <button type="submit" form="schedule-form" class="bg-indigo-600 text-white px-4 py-2 rounded-lg shadow hover:bg-airnav-blue transition-colors text-sm font-medium">Simpan Jadwal</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const addScheduleButton = document.getElementById('add-schedule-button');
            const addScheduleModal = document.getElementById('add-schedule-modal');
            const closeModalButton = document.getElementById('close-modal-button');
            const cancelButton = document.getElementById('cancel-button');
            const scheduleForm = document.getElementById('schedule-form');
            const scheduleIdInput = document.getElementById('schedule-id');
            const scheduleDateInput = document.getElementById('schedule-date');
            const technicianDropdownsContainer = document.getElementById('technician-dropdowns');

            // --- DATA CONTOH (Harusnya diambil dari database) ---
            const technicianList = [
                "Khoirul M.A.", "Argo Pragolo", "Amrizah Ridho W", "Silvy Retno Andriani","Tria Sabda Utama",
                "Febri Dwi C.", "M. Yusuf Triono", "Dani Ridzal", "Nur Shella Firdaus", "Saiful Bahris",
                "Moh. Syamsudin", "Yourdan C.P", "Rhomadoni S.K.D", "Safira Saraswati"
            ];
            
            // --- Fungsi untuk generate dropdown teknisi ---
            const createTechnicianDropdowns = () => {
                technicianDropdownsContainer.innerHTML = ''; // Kosongkan dulu
                for (let i = 1; i <= 5; i++) {
                    const select = document.createElement('select');
                    select.name = `teknisi-${i}`;
                    select.className = 'block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 text-sm';

                    // Opsi default
                    const defaultOption = document.createElement('option');
                    defaultOption.value = '';
                    defaultOption.textContent = `Pilih Teknisi ${i}` + (i > 1 ? ' (Opsional)' : '');
                    select.appendChild(defaultOption);
                    
                    // Isi dengan daftar teknisi
                    technicianList.forEach(name => {
                        const option = document.createElement('option');
                        option.value = name;
                        option.textContent = name;
                        select.appendChild(option);
                    });
                    
                    technicianDropdownsContainer.appendChild(select);
                }
            };

            // --- Logika Modal ---
            const openModal = () => {
                // Generate ID otomatis berdasarkan timestamp
                const timestamp = Date.now();
                const autoId = `CNSD-${timestamp.toString().slice(-6)}`;
                scheduleIdInput.value = autoId;

                // Set tanggal hari ini secara otomatis
                const today = new Date();
                const yyyy = today.getFullYear();
                const mm = String(today.getMonth() + 1).padStart(2, '0'); // Januari adalah 0
                const dd = String(today.getDate()).padStart(2, '0');
                scheduleDateInput.value = `${yyyy}-${mm}-${dd}`;
                
                addScheduleModal.classList.remove('hidden');
            };

            const closeModal = () => addScheduleModal.classList.add('hidden');

            addScheduleButton.addEventListener('click', openModal);
            closeModalButton.addEventListener('click', closeModal);
            cancelButton.addEventListener('click', closeModal);

            addScheduleModal.addEventListener('click', function(event) {
                if (event.target === addScheduleModal) {
                    closeModal();
                }
            });

            // --- Logika Form Submit ---
            scheduleForm.addEventListener('submit', function(event) {
                event.preventDefault(); 
                
                const formData = new FormData(scheduleForm);
                const teknisi = [];
                for(let i=1; i<=5; i++){
                    const teknisiName = formData.get(`teknisi-${i}`);
                    if(teknisiName) {
                        teknisi.push(teknisiName);
                    }
                }

                console.log('Form Disubmit:');
                console.log('ID Jadwal:', formData.get('schedule-id'));
                console.log('Tanggal:', formData.get('schedule-date'));
                console.log('Dinas:', formData.get('schedule-shift'));
                console.log('Teknisi:', teknisi);

                alert('Data jadwal baru telah disimpan! (Cek console log untuk detail)');
                
                scheduleForm.reset();
                closeModal();
            });

            // --- Inisialisasi ---
            createTechnicianDropdowns(); // Panggil fungsi untuk membuat dropdown saat halaman dimuat
        });
    </script>

</body>
</html>

