<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kegiatan TFP - AirNav</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>
        // Konfigurasi warna kustom AirNav
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'airnav-blue': '#255A9B',
                        'airnav-red': '#D92D20',
                        'indigo-600': '#255A9B',
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Style for clickable rows */
        .clickable-row {
            cursor: pointer;
        }
        .modal-body {
            max-height: 70vh;
            overflow-y: auto;
        }
    </style>
</head>
<body class="bg-gray-100">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        <!-- Header Halaman -->
        <header class="bg-white shadow-md rounded-lg p-4 mb-6 flex items-center justify-between">
            <div class="flex items-center">
                <a href="../index.html#tfp-content" class="p-2 rounded-md hover:bg-gray-200" aria-label="Kembali ke Dashboard">
                    <svg class="w-6 h-6 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                </a>
                <h1 class="text-xl md:text-2xl font-bold text-gray-800 ml-4">Log Kegiatan TFP</h1>
            </div>
            <img src="../img/airnav_logo.png" alt="Logo AirNav" class="w-10 h-10 object-contain" onerror="this.onerror=null;this.src='https://placehold.co/40x40/FFFFFF/255A9B?text=A';">
        </header>

        <!-- Main Content -->
        <main class="bg-white p-6 rounded-lg shadow-md">
            <!-- Aksi Tambah Kegiatan -->
            <div class="mb-6 flex justify-end">
                <button id="add-activity-button" class="bg-indigo-600 text-white px-4 py-2 rounded-lg shadow hover:bg-airnav-blue transition-colors text-sm font-medium flex items-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                    Tambah Kegiatan
                </button>
            </div>
            
            <!-- Tabel Kegiatan -->
            <div class="overflow-x-auto">
                <table class="w-full min-w-max text-sm text-left text-gray-600">
                    <thead class="text-xs text-gray-700 uppercase bg-gray-100">
                        <tr>
                            <th scope="col" class="px-4 py-3">Kode</th>
                            <th scope="col" class="px-4 py-3">Dinas</th>
                            <th scope="col" class="px-4 py-3">Tanggal</th>
                            <th scope="col" class="px-4 py-3">Mulai</th>
                            <th scope="col" class="px-4 py-3">Selesai</th>
                            <th scope="col" class="px-4 py-3">Alat</th>
                            <th scope="col" class="px-4 py-3">Permasalahan</th>
                            <th scope="col" class="px-4 py-3">Tindakan</th>
                            <th scope="col" class="px-4 py-3">Hasil</th>
                            <th scope="col" class="px-4 py-3">Status</th>
                            <th scope="col" class="px-4 py-3">Teknisi</th>
                            <th scope="col" class="px-4 py-3">Waktu Terputus</th>
                            <th scope="col" class="px-4 py-3">Lampiran</th>
                        </tr>
                    </thead>
                    <tbody id="activity-table-body">
                        <!-- Data dari database akan diisi di sini -->
                         <tr id="empty-row" class="text-center">
                           <td colspan="13" class="py-10 px-4 text-gray-500">
                                <p>Belum ada data kegiatan.</p>
                                <p class="text-sm">Silakan tambahkan kegiatan baru.</p>
                           </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </main>
    </div>

    <!-- Modal Tambah Kegiatan -->
    <div id="add-activity-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 hidden">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl">
            <!-- Modal Header -->
            <div class="flex justify-between items-center p-4 border-b">
                <h3 class="text-lg font-semibold text-gray-800">Tambah Kegiatan Baru</h3>
                <button id="close-modal-button" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <!-- Modal Body -->
            <form id="activity-form" class="modal-body p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="activity-code" class="block text-sm font-medium text-gray-700">Kode</label>
                        <input type="text" id="activity-code" name="activity-code" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 bg-gray-50" required>
                    </div>
                     <div>
                        <label for="activity-shift" class="block text-sm font-medium text-gray-700">Dinas</label>
                        <select id="activity-shift" name="activity-shift" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500" required>
                            <option value="">Pilih Dinas</option>
                            <option value="Pagi">Pagi</option>
                            <option value="Siang">Siang</option>
                            <option value="Malam">Malam</option>
                        </select>
                    </div>
                    <div>
                        <label for="activity-start-time" class="block text-sm font-medium text-gray-700">Waktu Mulai</label>
                        <input type="time" id="activity-start-time" name="activity-start-time" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500" required>
                    </div>
                    <div>
                        <label for="activity-end-time" class="block text-sm font-medium text-gray-700">Waktu Selesai</label>
                        <input type="time" id="activity-end-time" name="activity-end-time" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
                    </div>
                </div>
                <div>
                    <label for="activity-tool" class="block text-sm font-medium text-gray-700">Alat</label>
                    <input type="text" id="activity-tool" name="activity-tool" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500" required>
                </div>
                <div>
                    <label for="activity-problem" class="block text-sm font-medium text-gray-700">Permasalahan</label>
                    <textarea id="activity-problem" name="activity-problem" rows="3" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"></textarea>
                </div>
                <div>
                    <label for="activity-action" class="block text-sm font-medium text-gray-700">Tindakan</label>
                    <textarea id="activity-action" name="activity-action" rows="3" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"></textarea>
                </div>
                 <div>
                    <label for="activity-result" class="block text-sm font-medium text-gray-700">Hasil</label>
                    <textarea id="activity-result" name="activity-result" rows="3" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"></textarea>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="activity-status" class="block text-sm font-medium text-gray-700">Status</label>
                        <select id="activity-status" name="activity-status" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500" required>
                            <option value="Selesai">Selesai</option>
                            <option value="Proses">Proses</option>
                            <option value="Tertunda">Tertunda</option>
                        </select>
                    </div>
                     <div>
                        <label for="activity-downtime" class="block text-sm font-medium text-gray-700">Waktu Terputus</label>
                        <input type="text" id="activity-downtime" name="activity-downtime" placeholder="cth: 1 jam 15 mnt" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Teknisi</label>
                    <div id="technician-dropdowns" class="mt-2 grid grid-cols-1 sm:grid-cols-2 gap-2">
                        <!-- Dropdown teknisi akan di-generate oleh JavaScript -->
                    </div>
                </div>
                 <div>
                    <label for="activity-attachment" class="block text-sm font-medium text-gray-700">Lampiran</label>
                    <input type="file" id="activity-attachment" name="activity-attachment[]" multiple class="mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100"/>
                    <p class="text-xs text-gray-500 mt-1">Anda bisa memilih lebih dari satu file (gambar/foto).</p>
                </div>
            </form>
            <!-- Modal Footer -->
            <div class="flex justify-end items-center p-4 border-t bg-gray-50 rounded-b-lg">
                <button id="cancel-button" type="button" class="bg-white text-gray-700 px-4 py-2 rounded-lg border border-gray-300 hover:bg-gray-50 text-sm font-medium mr-2">Batal</button>
                <button type="submit" form="activity-form" class="bg-indigo-600 text-white px-4 py-2 rounded-lg shadow hover:bg-airnav-blue transition-colors text-sm font-medium">Simpan Kegiatan</button>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // --- Elemen-elemen ---
            const addActivityButton = document.getElementById('add-activity-button');
            const addActivityModal = document.getElementById('add-activity-modal');
            const closeModalButton = document.getElementById('close-modal-button');
            const cancelButton = document.getElementById('cancel-button');
            const activityForm = document.getElementById('activity-form');
            const activityCodeInput = document.getElementById('activity-code');
            const technicianDropdownsContainer = document.getElementById('technician-dropdowns');

             // --- DATA CONTOH (Harusnya diambil dari database) ---
            const technicianList = [
                "Iqbal Mustika", "Fajar Nugroho", "Bian Prasetia H.", "Sofi Dwi Hidayati",
                "Yoga Arifal P", "Karang Samudra", "M. Feizar Noor", "Fajar Kusuma W.",
                "Dwi Prasetyo Adi", "Andhika Bhaskara J.", "Agustina Anggreini"
            ];
            
            // --- Fungsi untuk generate dropdown teknisi ---
            const createTechnicianDropdowns = () => {
                technicianDropdownsContainer.innerHTML = '';
                for (let i = 1; i <= 5; i++) {
                    const select = document.createElement('select');
                    select.name = `teknisi-${i}`;
                    select.className = 'block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 text-sm';
                    
                    const defaultOption = document.createElement('option');
                    defaultOption.value = '';
                    defaultOption.textContent = `Pilih Teknisi ${i}` + (i > 1 ? ' (Opsional)' : '');
                    select.appendChild(defaultOption);
                    
                    technicianList.forEach(name => {
                        const option = document.createElement('option');
                        option.value = name;
                        option.textContent = name;
                        select.appendChild(option);
                    });
                    
                    technicianDropdownsContainer.appendChild(select);
                }
            };
            
            // --- Logika Modal ---
            const openModal = () => {
                const timestamp = Date.now();
                activityCodeInput.value = `KG-${timestamp.toString().slice(-6)}`;
                addActivityModal.classList.remove('hidden');
            };
            const closeModal = () => addActivityModal.classList.add('hidden');

            addActivityButton.addEventListener('click', openModal);
            closeModalButton.addEventListener('click', closeModal);
            cancelButton.addEventListener('click', closeModal);
            addActivityModal.addEventListener('click', (event) => {
                if (event.target === addActivityModal) closeModal();
            });

            // --- Logika Navigasi Baris Tabel ---
            const rows = document.querySelectorAll('.clickable-row');
            rows.forEach(row => {
                row.addEventListener('click', () => {
                    const href = row.dataset.href;
                    if (href) window.location.href = href;
                });
            });

            // --- Inisialisasi ---
            createTechnicianDropdowns();
        });
    </script>

</body>
</html>

