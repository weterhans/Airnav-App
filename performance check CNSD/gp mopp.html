<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>METER READING ILS GLIDE PATH (Fungsional)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        /* Menggunakan font Arial seperti di kode asli, Tailwind menggunakan default sans-serif yang mirip */
        body { font-family: Arial, sans-serif; }

        /* Container untuk tampilan cetak */
        .form-container-inner {
            max-width: 800px; /* Lebar yang mirip dengan container asli (max-width: 800px) */
            margin: 20px auto;
            border: 2px solid #000;
            background: white;
            color: #000;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            padding: 20px; /* Padding di container asli */
        }

        /* --- STYLES DARI CODINGAN PERTAMA (DIRETAIN) --- */
        
        /* Header, Detail, dan Signature Tables */
        .header-table, .detail-table { 
            width: 100%; border-collapse: collapse; font-size: 10pt; margin-top: 0; 
        }
        .header-table td { padding: 4px; height: 20px; border: none; vertical-align: top; }

        /* Header Title Row (Hampir Mirip aslinya) */
        .title-row { height: 30px; background-color: #DDEBF7; border: 2px solid #000; }
        .header-title { text-align: center; font-size: 14pt; font-weight: bold; padding: 8px 0; }

        /* ILS GLIDE PATH cell */
        .path-cell-container {
            background-color: #F8CBAD; text-align: center; font-weight: bold;
            border-left: 2px solid #000 !important; border-right: 1px solid #000 !important;
            padding: 0; vertical-align: top;
        }
        .path-cell-ils { font-size: 10pt; display: block; padding-top: 5px; }
        .path-cell-gp { font-size: 12pt; display: block; padding-bottom: 5px; }

        /* Kolom Kiri Header */
        .left-col { width: 15%; font-weight: bold; padding-left: 8px; border-left: 2px solid #000 !important; }
        .data-col { width: 35%; padding-right: 8px; }
        .empty-side-header { width: 15%; border-right: 2px solid #000 !important; }
        .empty-side-header-top { border-bottom: 1px solid #000 !important; }
        .empty-side-header-bottom { border-top: 1px solid #000 !important; }
        .bottom-border-thick { border-bottom: 2px solid #000 !important; border-top: 1px solid #000 !important; }
        .bottom-border-thick-merk { border-top: 2px solid #000 !important; }

        /* Detail Table Styles */
        .detail-table td, .detail-table th { border: 1px solid #000; padding: 4px; text-align: center; vertical-align: middle; }
        .detail-table.meter-reading-table-end { border-top: none; }
        .detail-table.lingkungan-kerja-table-start { border-top: 1px solid #000 !important; }

        .detail-header { background-color: #B4C6E7; font-weight: bold; text-align: center; color: #000; }
        .row-green { background-color: #E2EFDA; font-weight: bold; }
        .text-center { text-align: center; }
        .text-bold { font-weight: bold; }
        
        .nom-col { width: 10%; } 
        .tx-col-combined { width: 15%; } 
        .ket-col { width: 25%; } 
        .detail-table tr:not(.row-green) td { font-weight: normal; }

        /* Signature Table Styles */
        .signature-table th { font-size: 10pt; font-weight: bold; text-align: center; height: 25px; vertical-align: bottom; padding-bottom: 4px; }
        .signature-table td { height: 30px; }
        .signature-table tr:first-child td { height: 20px; } /* Row No, Nama, Paraf */

        /* Input Styles (Penting untuk Retain Tampilan) */
        input[type="text"], input[type="date"], select, textarea {
            font-family: Arial, sans-serif; font-size: 10pt; padding: 0 2px; margin: 0;
            box-sizing: border-box; line-height: normal; background: none; border: none;
            width: 100%; height: 100%; display: block;
        }

        /* Khusus input TGL/JAM */
        .header-table input[type="date"], .header-table select.jam-dropdown {
            border: 1px solid #ccc; display: inline-block; vertical-align: middle;
            font-size: 10pt; padding: 0 2px; height: 20px; background: white;
        }
        .header-table input[type="date"] { width: 55%; }
        .header-table select.jam-dropdown { width: 40%; margin-left: 5px; }

        /* Gaya tambahan untuk dropdown di tabel detail */
        .detail-table select {
            width: 100%; border: 1px solid #ccc; padding: 2px; font-size: 10pt; 
            display: block; margin: auto; background: white; height: 100%;
        }

        /* Gaya khusus untuk input di dalam sel tabel detail (A dan B) */
        .detail-table input[type="text"], .detail-table input[type="number"] {
            border: none; text-align: center; padding: 0; margin: 0; box-sizing: border-box; 
        }
        .detail-table td:last-child > input[type="text"] { text-align: left; }
        
        /* Area Tanda Tangan */
        .super-col, .manager-col { position: relative; padding: 0 !important; }
        .super-col > textarea, .manager-col > textarea {
            position: absolute; top: 0; left: 0; z-index: 1; /* Di bawah div pengetikan */
            border: none; resize: none; width: 100%; height: 100%; padding: 0;
        }
        .signature-name-area {
            position: absolute; bottom: 5px; width: 100%; text-align: center;
            font-size: 10pt; font-weight: bold; z-index: 2; 
        }
        .signature-name-area input[type="text"] {
            display: inline-block; width: 70%; border: none; border-bottom: 1px solid #000; 
            text-align: center; font-weight: bold; padding: 0; margin: 0; background: none;
            height: auto; /* Override default height for better fit */
        }
        .tek-col input { border: none !important; height: 100%; padding: 0 4px; }
        
        /* PRINT STYLES */
        @media print {
            @page { size: A4 portrait; margin: 6mm; }
            body { margin: 0; background-color: white; -webkit-print-color-adjust: exact; print-color-adjust: exact; font-size: 12px; }
            .no-print { display: none !important; }
            #form-container { display: block !important; padding: 0 !important; }
            #list-container, #main-controls { display: none !important; }
            .form-container-inner { box-shadow: none; border: 2px solid #000; margin: 0; max-width: 100%; padding: 0; }
            .logo-img { height: 60px; margin-bottom: 0px; }
            
            /* Print value styling */
            input, select, textarea { display: none !important; }
            .print-value {
                display: block !important; 
                font-size: 10pt !important; 
                line-height: normal;
                padding: 0 2px;
                border: none !important;
                background: transparent !important;
                color: black !important;
                text-align: inherit !important; /* Agar teks mengikuti align di cell */
            }
            .header-table .print-value { display: inline-block !important; }
            .header-table td.data-col .print-value { display: inline-block !important; }
            
            /* Override for signature area */
            .signature-name-area .print-value { 
                border-bottom: 1px solid #000 !important; 
                width: 70%; 
                display: inline-block !important;
                font-weight: bold !important;
                text-align: center !important;
            }
            .super-col, .manager-col { padding: 4px !important; } /* Restore some padding for content */
        }
    </style>
</head>
<body class="bg-gray-100">
    
    <div id="main-content" class="max-w-7xl mx-auto p-4 md:p-6">
        
        <div id="main-controls" class="bg-white p-6 rounded-lg shadow-md mb-6 no-print flex items-center justify-between">
            <div>
                <div class="flex items-center">
                    <a href="performance_cnsd.html" onclick="history.back(); return false;" class="flex items-center text-gray-600 hover:text-gray-800 font-semibold p-2 rounded-md hover:bg-gray-200">
                        <svg class="w-6 h-6 mr-0" fill="none" stroke="currentColor" viewBox="0 0 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                    </a>
                    <h1 class="text-2xl font-bold text-gray-800 ml-4">Meter Reading Glide Path Mopiens </h1>
                </div>
                
                <div class="mt-4 flex flex-wrap gap-4">
                    <button id="create-new-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg">Buat Data Baru</button>
                    <button id="view-list-btn" class="bg-gray-600 hover:bg-gray-700 text-white px-6 py-2 rounded-lg">Lihat Daftar Data</button>
                </div>
            </div>
            <img src="../img/airnav.png" alt="AirNav Logo" class="h-12 w-auto">
        </div>

        <div id="form-container" class="hidden">
            <form id="ils-gp-form">
                <input type="hidden" id="data_id" name="id">
                <div class="form-container-inner">
                    <div class="logo-area">
                        <img id="logo-img" src="../img/airnav_logo.png" alt="Logo AirNav" class="logo-img">
                    </div>
                    
                    <table class="header-table">
                        <tr class="title-row" style="border-top: 2px solid #000 !important;">
                            <td colspan="2" class="left-col" style="border-top: 2px solid #000; border-right: 1px solid #000 !important;"></td>
                            <td colspan="2" class="header-title" style="border-top: 2px solid #000; border-right: 1px solid #000 !important;">METER READING</td>
                            <td colspan="2" class="empty-side-header" style="border-top: 2px solid #000; border-left: 2px solid #000 !important;"></td>
                        </tr>
                        
                        <tr>
                            <td class="left-col" style="height: 18px; border-bottom: 1px solid #000 !important; vertical-align: middle;">LOKASI</td>
                            <td class="data-col" style="height: 18px; border-bottom: 1px solid #000 !important; border-right: 1px solid #000 !important; vertical-align: middle;">: <span class="print-value">CABANG SURABAYA</span></td>
                            
                            <td colspan="2" rowspan="2" class="path-cell-container" style="border-bottom: 2px solid #000 !important;">
                                <span class="path-cell-ils">ILS</span>
                                <span class="path-cell-gp">GLIDE PATH</span>
                            </td>
                            
                            <td colspan="2" class="empty-side-header empty-side-header-top" style="height: 18px;"></td>
                        </tr>
                        <tr>
                            <td class="left-col" style="height: 25px; border-bottom: 2px solid #000 !important; vertical-align: middle;">TGL/JAM</td>
                            <td class="data-col" style="height: 25px; border-bottom: 2px solid #000 !important; border-right: 1px solid #000 !important; vertical-align: middle;">: 
                                <input type="date" id="tanggal" name="tanggal" class="form-input-header">
                                <select class="jam-dropdown form-input-header" id="shift" name="shift">
                                    <option value="">-- Jam --</option>
                                    <option value="0700-1300">07.00 - 13.00</option>
                                    <option value="1300-1900">13.00 - 19.00</option>
                                    <option value="1900-0700">19.00 - 07.00</option>
                                </select>
                            </td>
                            <td colspan="2" class="empty-side-header empty-side-header-bottom" style="height: 25px;"></td>
                        </tr>
                        
                        <tr>
                            <td class="left-col bottom-border-thick-merk" style="height: 18px;">MERK</td>
                            <td class="data-col bottom-border-thick-merk" style="height: 18px;">: <span class="print-value">MOPIENS</span></td>
                            <td colspan="4" class="empty-side-header bottom-border-thick-merk" style="height: 18px;"></td>
                        </tr>
                        
                        <tr class="bottom-border-thick">
                            <td class="left-col bottom-border-thick" style="height: 18px;">TYPE</td>
                            <td class="data-col bottom-border-thick" style="height: 18px;">: <span class="print-value">500</span></td>
                            <td colspan="4" class="empty-side-header bottom-border-thick" style="height: 18px;"></td>
                        </tr>
                    </table>

                    <table class="detail-table meter-reading-table-end" style="border-top: none;">
                        <thead>
                            <tr class="detail-header">
                                <th style="width: 3%;" rowspan="2" class="text-center">NO</th>
                                <th style="width: 37%;" rowspan="2" class="text-center">PEMBACAAN METER READING</th>
                                <th class="nom-col text-center" rowspan="2">NOMINAL</th>
                                <th style="width: 25%;" colspan="2" class="text-center">HASIL PEMERIKSAAN</th>
                                <th class="ket-col text-center" rowspan="2">KETERANGAN</th>
                            </tr>
                            <tr class="detail-header">
                                <th class="tx-col-combined text-center">TX1</th>
                                <th class="tx-col-combined text-center">TX2</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="row-green">
                                <td rowspan="7" class="text-center">1</td>
                                <td style="font-weight: bold;">FRONT PANEL</td>
                                <td style="font-weight: bold;">Standart</td>
                                <td colspan="2"></td> 
                                <td></td>
                            </tr>
                            <tr>
                                <td>All Status Indikator</td>
                                <td>Normal / Alarm</td>
                                <td>
                                    <select class="form-input">
                                        <option value=""></option>
                                        <option value="Normal">Normal</option>
                                        <option value="Alarm">Alarm</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="form-input">
                                        <option value=""></option>
                                        <option value="Normal">Normal</option>
                                        <option value="Alarm">Alarm</option>
                                    </select>
                                </td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            <tr>
                                <td>Main Selected</td>
                                <td class="text-center" style="font-size: 14pt;">&check; / -</td> 
                                <td>
                                    <select class="form-input">
                                        <option value=""></option>
                                        <option value="Check">&check;</option>
                                        <option value="Strip">-</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="form-input">
                                        <option value=""></option>
                                        <option value="Check">&check;</option>
                                        <option value="Strip">-</option>
                                    </select>
                                </td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            <tr>
                                <td>TX On AIR</td>
                                <td class="text-center" style="font-size: 14pt;">&check; / -</td>
                                <td>
                                    <select class="form-input">
                                        <option value=""></option>
                                        <option value="Check">&check;</option>
                                        <option value="Strip">-</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="form-input">
                                        <option value=""></option>
                                        <option value="Check">&check;</option>
                                        <option value="Strip">-</option>
                                    </select>
                                </td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            <tr>
                                <td>TX Stby</td>
                                <td class="text-center" style="font-size: 14pt;">&check; / -</td>
                                <td>
                                    <select class="form-input">
                                        <option value=""></option>
                                        <option value="Check">&check;</option>
                                        <option value="Strip">-</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="form-input">
                                        <option value=""></option>
                                        <option value="Check">&check;</option>
                                        <option value="Strip">-</option>
                                    </select>
                                </td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            <tr>
                                <td>Control Status</td>
                                <td>Local / Remote</td>
                                <td>
                                    <select class="form-input">
                                        <option value=""></option>
                                        <option value="Local">Local</option>
                                        <option value="Remote">Remote</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="form-input">
                                        <option value=""></option>
                                        <option value="Local">Local</option>
                                        <option value="Remote">Remote</option>
                                    </select>
                                </td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            <tr>
                                <td>DC Power Suplay</td>
                                <td>28 V</td>
                                <td colspan="2"><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            
                            <tr class="row-green">
                                <td rowspan="4" class="text-center">2</td>
                                <td style="font-weight: bold;">CL (Course Line)</td>
                                <td style="font-weight: bold;">Standart</td>
                                <td class="text-center">M1</td>
                                <td class="text-center">M2</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>DDM</td>
                                <td>0.00%</td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            <tr>
                                <td>SDM</td>
                                <td>80%</td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            <tr>
                                <td>Level</td>
                                <td>0.00dB</td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            
                            <tr class="row-green">
                                <td rowspan="4" class="text-center">3</td>
                                <td style="font-weight: bold;">DS (Displacement Sensitivity)</td>
                                <td style="font-weight: bold;">Standart</td>
                                <td class="text-center">M1</td>
                                <td class="text-center">M2</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>DDM</td>
                                <td>17.50%</td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            <tr>
                                <td>SDM</td>
                                <td>80%</td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            <tr>
                                <td>Level</td>
                                <td>0.00dB</td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            
                            <tr class="row-green">
                                <td rowspan="4" class="text-center">4</td>
                                <td style="font-weight: bold;">CLR (Clearance)</td>
                                <td style="font-weight: bold;">Standart</td>
                                <td class="text-center">M1</td>
                                <td class="text-center">M2</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>DDM</td>
                                <td>50.00%</td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            <tr>
                                <td>SDM</td>
                                <td>80%</td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            <tr>
                                <td>Level</td>
                                <td>0.00dB</td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            
                            <tr class="row-green">
                                <td rowspan="4" class="text-center">5</td>
                                <td style="font-weight: bold;">Near Field</td>
                                <td style="font-weight: bold;">Standart</td>
                                <td class="text-center">M1</td>
                                <td class="text-center">M2</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>DDM</td>
                                <td>0.00</td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            <tr>
                                <td>SDM</td>
                                <td>80.00</td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            <tr>
                                <td>Level</td>
                                <td>0.00</td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            
                            <tr class="row-green">
                                <td rowspan="4" class="text-center">6</td>
                                <td style="font-weight: bold;">Power Supply</td>
                                <td style="font-weight: bold;">Standart</td>
                                <td colspan="2"></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>DC/DC-A</td>
                                <td>5V</td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td>15V</td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td>-15V</td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            
                            <tr class="row-green">
                                <td rowspan="6" class="text-center">7</td>
                                <td style="font-weight: bold;">Power Supply</td>
                                <td style="font-weight: bold;">Standart</td>
                                <td colspan="2"></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>DC/DC</td>
                                <td>5V</td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td>8V</td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td>15V</td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td>-15V</td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td>28V</td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                            
                            <tr class="row-green">
                                <td rowspan="2" class="text-center">8</td>
                                <td style="font-weight: bold;">Power Supply</td>
                                <td style="font-weight: bold;">Standart</td>
                                <td colspan="2"></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Baterai</td>
                                <td></td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                                <td><input type="text" class="form-input"></td>
                            </tr>
                        </tbody>
                    </table>

                    <table class="detail-table lingkungan-kerja-table-start">
                        <thead>
                            <tr>
                                <td colspan="7" class="text-bold" style="border-bottom: none !important; border-top: none !important; padding-top: 10px; text-align: left;">B: LINGKUNGAN KERJA</td>
                            </tr>
                            <tr class="row-green">
                                <th style="width: 3%;" class="text-center">NO</th>
                                <th style="width: 40%; text-align: left;" colspan="2">KEGIATAN</th>
                                <th class="nom-col text-center">Nominal</th>
                                <th style="width: 25%;" colspan="2" class="text-center">HASIL PEMERIKSAAN</th>
                                <th class="ket-col text-center">KETERANGAN</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="text-center">1</td>
                                <td colspan="2" style="text-align: left;">PEMERIKSAAN SUHU RUANGAN</td>
                                <td class="text-center">< 22Â° C</td>
                                <td colspan="2">
                                    <input type="text" class="form-input">
                                </td>
                                <td>
                                    <input type="text" class="form-input">
                                </td>
                            </tr>
                            <tr>
                                <td class="text-center">2</td>
                                <td colspan="2" style="text-align: left;">PEMERIKSAAN AIR HUMIDITY</td>
                                <td class="text-center" style="font-size: 14pt;">&check;</td>
                                <td colspan="2">
                                    <input type="text" class="form-input">
                                </td>
                                <td>
                                    <input type="text" class="form-input">
                                </td>
                            </tr>
                            <tr>
                                <td class="text-center">3</td>
                                <td colspan="2" style="text-align: left;">PEMERIKSAAN KEBERSIHAN RUANGAN</td>
                                <td class="text-center" style="font-size: 14pt;">&check;</td>
                                <td colspan="2">
                                    <input type="text" class="form-input">
                                </td>
                                <td>
                                    <input type="text" class="form-input">
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <table class="detail-table signature-table" style="border-top: none;">
                        <thead>
                            <tr class="detail-header">
                                <th colspan="3" style="width: 40%;">Teknisi</th>
                                <th style="width: 30%;">SUPERVISOR</th>
                                <th style="width: 30%;">MANAGER TEKNIK</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="text-center text-bold" style="border-bottom: 1px solid #000;">No</td>
                                <td class="text-bold" style="border-bottom: 1px solid #000;">NAMA</td>
                                <td class="text-bold" style="border-bottom: 1px solid #000;">Paraf</td>
                                
                                <td rowspan="5" class="super-col" style="border-bottom: 2px solid #000;">
                                    <textarea name="super_area" class="form-input"></textarea>
                                    <div class="signature-name-area">
                                        ( <input type="text" id="supervisor" name="supervisor" class="form-input"> )
                                    </div>
                                </td>
                                
                                <td rowspan="5" class="manager-col" style="border-bottom: 2px solid #000;">
                                    <textarea name="manager_area" class="form-input"></textarea>
                                    <div class="signature-name-area">
                                        ( <input type="text" id="manager" name="manager" class="form-input"> )
                                    </div>
                                </td>
                            </tr>
                            <tr class="tek-row">
                                <td class="text-center">1</td>
                                <td class="tek-col"><input type="text" class="teknisi-nama" name="teknisi_nama_1"></td>
                                <td class="tek-col"><input type="text" class="teknisi-paraf" name="teknisi_paraf_1"></td>
                            </tr>
                            <tr class="tek-row">
                                <td class="text-center">2</td>
                                <td class="tek-col"><input type="text" class="teknisi-nama" name="teknisi_nama_2"></td>
                                <td class="tek-col"><input type="text" class="teknisi-paraf" name="teknisi_paraf_2"></td>
                            </tr>
                            <tr class="tek-row">
                                <td class="text-center">3</td>
                                <td class="tek-col"><input type="text" class="teknisi-nama" name="teknisi_nama_3"></td>
                                <td class="tek-col"><input type="text" class="teknisi-paraf" name="teknisi_paraf_3"></td>
                            </tr>
                            <tr class="tek-row">
                                <td class="text-center" style="border-bottom: 2px solid #000;">4</td>
                                <td style="border-bottom: 2px solid #000;"><input type="text" class="teknisi-nama" name="teknisi_nama_4"></td>
                                <td style="border-bottom: 2px solid #000;"><input type="text" class="teknisi-paraf" name="teknisi_paraf_4"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </form>

            <div class="flex justify-center gap-4 mt-6 no-print">
                <button type="button" id="save-btn" class="bg-green-600 hover:bg-green-700 text-white px-8 py-2 rounded-lg font-semibold">Simpan</button>
                <button type="button" id="print-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white px-8 py-2 rounded-lg font-semibold">Print Form</button>
                <button type="button" id="cancel-btn" class="bg-red-600 hover:bg-red-700 text-white px-8 py-2 rounded-lg font-semibold">Batal</button>
            </div>
        </div>
        
        <div id="list-container" class="bg-white p-6 rounded-lg shadow-md">
            <h3 class="text-lg font-bold leading-6 text-gray-900 mb-4">Daftar Meter Reading ILS GLIDE PATH</h3>
            <div id="tableContent" class="overflow-x-auto"></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const formContainer = document.getElementById('form-container');
            const listContainer = document.getElementById('list-container');
            const tableContent = document.getElementById('tableContent');
            const ilsGpForm = document.getElementById('ils-gp-form');
            const dataIdInput = document.getElementById('data_id');
            
            const createNewBtn = document.getElementById('create-new-btn');
            const viewListBtn = document.getElementById('view-list-btn');
            const saveBtn = document.getElementById('save-btn');
            const printBtn = document.getElementById('print-btn');
            const cancelBtn = document.getElementById('cancel-btn');

            let currentEditId = null;
            const STORAGE_KEY = 'meterReadingData_ILSGP';

            // --- Utility Functions ---

            const showForm = () => {
                formContainer.classList.remove('hidden');
                listContainer.classList.add('hidden');
                window.scrollTo(0, 0);
            };

            const showList = () => {
                formContainer.classList.add('hidden');
                listContainer.classList.remove('hidden');
                loadTableData();
            };

            const getSavedData = () => JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
            const saveAllData = (data) => localStorage.setItem(STORAGE_KEY, JSON.stringify(data));

            const clearForm = () => {
                ilsGpForm.reset();
                dataIdInput.value = '';
                currentEditId = null;
                // Set default values (must match the non-editable texts)
                
                // Set today's date and default shift
                const today = new Date();
                const yyyy = today.getFullYear();
                const mm = String(today.getMonth() + 1).padStart(2, '0');
                const dd = String(today.getDate()).padStart(2, '0');
                document.getElementById('tanggal').value = `${yyyy}-${mm}-${dd}`;
                
                const jam = today.getHours();
                let shiftValue = '1900-0700'; // Default malam
                if (jam >= 7 && jam < 13) shiftValue = '0700-1300';
                else if (jam >= 13 && jam < 19) shiftValue = '1300-1900';
                document.getElementById('shift').value = shiftValue;

                saveBtn.innerText = 'Simpan Data';
            };

            const collectFormData = (id) => {
                // Collect all form inputs that need to be saved
                const formInputs = Array.from(ilsGpForm.querySelectorAll('.form-input')).map(input => input.value);
                const teknisiNama = Array.from(ilsGpForm.querySelectorAll('.teknisi-nama')).map(el => el.value);
                const teknisiParaf = Array.from(ilsGpForm.querySelectorAll('.teknisi-paraf')).map(el => el.value);

                return {
                    id: id || Date.now(),
                    tanggal: document.getElementById('tanggal').value,
                    shift: document.getElementById('shift').options[document.getElementById('shift').selectedIndex]?.text || '-- Jam --',
                    shiftValue: document.getElementById('shift').value,
                    lokasi: 'CABANG SURABAYA',
                    merk: 'MOPIENS',
                    type: '500',
                    supervisor: document.getElementById('supervisor').value,
                    manager: document.getElementById('manager').value,
                    super_area: ilsGpForm.querySelector('textarea[name="super_area"]').value,
                    manager_area: ilsGpForm.querySelector('textarea[name="manager_area"]').value,
                    teknisi: teknisiNama,
                    paraf: teknisiParaf,
                    dataInput: formInputs
                };
            };
            
            const populateForm = (data) => {
                currentEditId = data.id;
                dataIdInput.value = data.id;
                document.getElementById('tanggal').value = data.tanggal;
                document.getElementById('shift').value = data.shiftValue;
                document.getElementById('supervisor').value = data.supervisor;
                document.getElementById('manager').value = data.manager;
                ilsGpForm.querySelector('textarea[name="super_area"]').value = data.super_area || '';
                ilsGpForm.querySelector('textarea[name="manager_area"]').value = data.manager_area || '';
                
                document.querySelectorAll('.form-input').forEach((input, i) => input.value = data.dataInput[i] || '');
                document.querySelectorAll('.teknisi-nama').forEach((input, i) => input.value = data.teknisi[i] || '');
                document.querySelectorAll('.teknisi-paraf').forEach((input, i) => input.value = data.paraf[i] || '');
                
                saveBtn.innerText = 'Perbarui Data';
                showForm();
            };

            // --- CRUD Operations ---

            const handleSave = () => {
                const tanggal = document.getElementById('tanggal').value;
                if (!tanggal) {
                    Swal.fire('Error', 'Tanggal wajib diisi!', 'error');
                    return;
                }
                
                const savedData = getSavedData();
                const formData = collectFormData(currentEditId);

                if (currentEditId) {
                    const index = savedData.findIndex(data => data.id === currentEditId);
                    if (index !== -1) savedData[index] = formData;
                } else {
                    savedData.push(formData);
                }

                saveAllData(savedData);
                Swal.fire('Sukses!', `Data berhasil ${currentEditId ? 'diperbarui' : 'disimpan'}.`, 'success');
                clearForm();
                showList();
            };

            const handleCancel = () => {
                Swal.fire({
                    title: 'Anda yakin?',
                    text: "Perubahan yang belum disimpan akan hilang.",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Ya, batalkan!',
                    cancelButtonText: 'Tidak'
                }).then((result) => {
                    if (result.isConfirmed) {
                        clearForm();
                        showList();
                    }
                });
            };

            const handleDelete = (id) => {
                Swal.fire({
                    title: 'Anda yakin ingin menghapus data ini?',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#d33',
                    confirmButtonText: 'Ya, hapus!',
                    cancelButtonText: 'Batal'
                }).then((result) => {
                    if (result.isConfirmed) {
                        let data = getSavedData();
                        data = data.filter(item => item.id !== id);
                        saveAllData(data);
                        Swal.fire('Terhapus!', 'Data telah berhasil dihapus.', 'success');
                        loadTableData();
                    }
                });
            };

            const loadTableData = () => {
                const data = getSavedData();
                if (data.length === 0) {
                    tableContent.innerHTML = '<p class="text-center text-gray-500 py-8">Belum ada data yang tersimpan.</p>';
                    return;
                }
                const tableHtml = `
                    <div class="overflow-x-auto border border-gray-200 rounded-lg">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">No</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tanggal</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Shift</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                ${data.sort((a, b) => new Date(b.tanggal) - new Date(a.tanggal)).map((item, index) => `
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${index + 1}</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${item.tanggal}</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${item.shift}</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                Selesai
                                            </span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                            <a href="#" onclick="event.preventDefault(); window.app.editData(${item.id})" class="text-blue-600 hover:text-blue-800">Edit</a>
                                            <a href="#" onclick="event.preventDefault(); window.app.deleteData(${item.id})" class="text-red-600 hover:text-red-800 ml-4">Hapus</a>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>`;
                tableContent.innerHTML = tableHtml;
            };

            // --- Print Logic (Enhanced to handle complex table structure) ---

            const handlePrint = (data) => {
                if (!data) return;

                // 1. Fill the form with data (without showing it to the user)
                populateForm(data); 

                // 2. Temporarily replace inputs/selects with static spans for printing
                const formToPrint = document.getElementById('ils-gp-form');
                
                const processElements = (selector, getTextContent, parentSelector = '#ils-gp-form') => {
                    const elements = Array.from(formToPrint.querySelectorAll(selector));
                    elements.forEach(el => {
                        const span = document.createElement('span');
                        span.textContent = getTextContent(el) || ' ';
                        span.className = 'print-value';
                        // Copy specific styles needed for alignment/positioning
                        span.style.cssText = el.style.cssText; 
                        
                        // Special handling for signature area to show name
                        if (el.parentNode.classList.contains('signature-name-area')) {
                            el.parentNode.insertBefore(span, el.parentNode.childNodes[2]); // Insert inside ( )
                            el.style.display = 'none';
                        } else {
                            el.parentNode.replaceChild(span, el);
                        }
                    });
                };

                // A. Header Inputs
                processElements('.form-input-header[type="date"]', el => el.value);
                processElements('.form-input-header.jam-dropdown', el => el.options[el.selectedIndex]?.text);

                // B. Detail/Signature Inputs
                processElements('.detail-table input[type="text"]', el => el.value);
                processElements('.detail-table select', el => el.options[el.selectedIndex]?.text);
                processElements('.detail-table textarea', el => el.value);


                window.print();

                // Restore form elements are handled by window.onafterprint or page reload
            };

            // --- Event Listeners and Global App Object ---

            createNewBtn.addEventListener('click', () => {
                clearForm();
                showForm();
            });
            viewListBtn.addEventListener('click', showList);
            saveBtn.addEventListener('click', handleSave);
            cancelBtn.addEventListener('click', handleCancel);

            // Print button on the form (only prints current, possibly unsaved state)
            printBtn.addEventListener('click', () => {
                handlePrint(collectFormData(currentEditId || Date.now()));
            });

            // Restore state after print
            window.onafterprint = () => {
                // Easiest way to restore a complex form with inputs/selects is to reload, 
                // then navigate back to the list view (default behavior)
                location.reload(); 
            };
            
            // Global App methods for list table
            window.app = {
                showList,
                editData: (id) => {
                    const data = getSavedData().find(d => d.id === id);
                    if (data) populateForm(data);
                },
                deleteData: handleDelete,
                printData: (id) => {
                     const data = getSavedData().find(d => d.id === id);
                     if (data) handlePrint(data);
                }
            };
            
            // Initial load
            clearForm();
            showList();
        });
    </script>
</body>
</html>